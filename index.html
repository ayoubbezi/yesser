<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BioGold - eCommerce Website</title>

  <link rel="shortcut icon" href="./assets/images/logo/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./assets/css/style.css">
  <link rel="stylesheet" href="./assets/css/gold-theme.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap"
    rel="stylesheet">
</head>

<body>
  <div class="overlay" data-overlay></div>

  <!-- Header will be loaded here -->
  <div id="header-container"></div>

  <main>
    <!-- BANNER -->
    <div class="banner">
      <div class="container">
        <div class="slider-item">
          <img src="./assets/images/ff.svg" alt="Summer Collection" class="banner-img">
          <div class="banner-content">
            <p class="banner-subtitle" data-translate="trendingItem">Trending item</p>
            <h2 class="banner-title" data-translate="summerCollection">Summer Collection</h2>
            <p class="banner-text" data-translate="startingAt">starting at 20 TND</p>
            <a href="#products" class="banner-btn" data-translate="shopNow">Shop now</a>
          </div>
        </div>
      </div>
    </div>

    <!-- PRODUCTS -->
    <div class="product-container" id="products">
      <div class="container">
        <h2 class="section-title" data-translate="ourProducts">Our Products</h2>
        <div class="product-box">
          <!-- Products will be loaded dynamically -->
        </div>
        <div class="product-navigation">
          <button class="nav-btn prev-btn" onclick="scrollProducts('left')">
            <ion-icon name="chevron-back-outline"></ion-icon>
          </button>
          <button class="nav-btn next-btn" onclick="scrollProducts('right')">
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </button>
        </div>
      </div>
    </div>

    <!-- CONTACT -->
    <div class="contact-section" id="contact">
      <div class="container">
        <h2 class="section-title" data-translate="contactHeader">Contact Us</h2>
        <p class="section-subtitle" data-translate="contactSubtitle">We'd love to hear from you! Send us a message and we'll respond as soon as possible.</p>
        
        <div class="contact-container">
          <div class="contact-info-box">
            <div class="contact-info-item">
              <div class="contact-info-icon">
                <ion-icon name="call"></ion-icon>
              </div>
              <div class="contact-info-text">
                <h3 data-translate="phone">Phone</h3>
                <p>+1 234 567 890</p>
              </div>
            </div>
            
            <div class="contact-info-item">
              <div class="contact-info-icon">
                <ion-icon name="mail"></ion-icon>
              </div>
              <div class="contact-info-text">
                <h3 data-translate="email">Email</h3>
                <p>contact@biogold.com</p>
              </div>
            </div>
            
            <div class="contact-info-item">
              <div class="contact-info-icon">
                <ion-icon name="location"></ion-icon>
              </div>
              <div class="contact-info-text">
                <h3 data-translate="address">Address</h3>
                <p>123 Street, City, Country</p>
              </div>
            </div>
            
            <div class="contact-social">
              <h3 data-translate="followUs">Follow Us</h3>
              <div class="contact-social-links">
                <a href="#" class="contact-social-link"><ion-icon name="logo-facebook"></ion-icon></a>
                <a href="#" class="contact-social-link"><ion-icon name="logo-twitter"></ion-icon></a>
                <a href="#" class="contact-social-link"><ion-icon name="logo-instagram"></ion-icon></a>
                <a href="#" class="contact-social-link"><ion-icon name="logo-linkedin"></ion-icon></a>
              </div>
            </div>
          </div>
          
          <form id="contact-form" class="contact-form" onsubmit="handleContactSubmit(event)">
          <div class="form-group">
              <label for="name" data-translate="yourName">Your Name</label>
              <input type="text" id="name" name="name" data-translate-placeholder="yourName" placeholder="Enter your name" required>
          </div>
          <div class="form-group">
              <label for="email" data-translate="yourEmail">Your Email</label>
              <input type="email" id="email" name="email" data-translate-placeholder="yourEmail" placeholder="Enter your email" required>
          </div>
          <div class="form-group">
              <label for="message" data-translate="yourMessage">Your Message</label>
              <textarea id="message" name="message" data-translate-placeholder="whatToTell" placeholder="What would you like to tell us?" required></textarea>
          </div>
            <button type="submit" class="submit-btn">
              <ion-icon name="paper-plane-outline"></ion-icon>
              <span data-translate="sendMessage">Send Message</span>
            </button>
        </form>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer will be loaded here -->
  <div id="footer-container"></div>

  <!-- Mobile Bottom Navigation -->
  <div class="mobile-nav">
    <a href="#" class="active">
      <ion-icon name="home-outline"></ion-icon>
      <span>Home</span>
    </a>
    <a href="#products">
      <ion-icon name="grid-outline"></ion-icon>
      <span>Shop</span>
    </a>
    <a href="#" id="mobile-categories-btn">
      <ion-icon name="apps-outline"></ion-icon>
      <span>Categories</span>
    </a>
    <a href="wishlist.html">
      <ion-icon name="heart-outline"></ion-icon>
      <span>Wishlist</span>
      <span class="mobile-nav-badge wishlist-count">0</span>
    </a>
    <a href="cart.html">
      <ion-icon name="bag-outline"></ion-icon>
      <span>Cart</span>
      <span class="mobile-nav-badge cart-count">0</span>
    </a>
  </div>

  <!-- Mobile Category Menu -->
  <div class="mobile-category-menu" id="mobileCategoryMenu">
    <div class="mobile-category-header">
      <h3>Categories</h3>
      <button class="mobile-category-close">
        <ion-icon name="close-outline"></ion-icon>
      </button>
    </div>
    <ul class="mobile-category-list" id="mobileCategoryList">
      <!-- Categories will be loaded dynamically -->
    </ul>
  </div>
  <div class="mobile-category-overlay" id="mobileCategoryOverlay"></div>

  <!-- ionicon link -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

  <!-- Config file -->
  <script src="./config.js"></script>
  
  <!-- custom js link -->
  <script src="./components.js"></script>

  <script>
    // Load header and footer
    document.getElementById('header-container').innerHTML = loadHeader();
    document.getElementById('footer-container').innerHTML = loadFooter();

    // Initialize components after DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      initializeComponents();
      loadProducts();
    });

    // Global variables
    let allProducts = []; // Store all products globally
    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || []; // Initialize wishlist from localStorage

    // Function to update cart count in header
    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      
      // Update header cart count
      const cartCount = document.querySelector('.header-user-actions .action-btn:last-child .count');
      if (cartCount) {
        cartCount.textContent = totalItems;
      }
      
      // Update mobile navigation cart count
      const mobileCartCount = document.querySelector('.mobile-nav .cart-count');
      if (mobileCartCount) {
        mobileCartCount.textContent = totalItems;
        mobileCartCount.style.display = totalItems > 0 ? 'flex' : 'none';
      }
    }

    function updateWishlistCount() {
      try {
        const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
        const count = wishlist.length;
        console.log('Updating wishlist count:', count);
        
        // Update all wishlist count elements in the document
        const wishlistCountElements = document.querySelectorAll('.wishlist-count');
        console.log('Found wishlist count elements:', wishlistCountElements.length);
        
        wishlistCountElements.forEach(element => {
          element.textContent = count;
          // Make badge visible only if there are items
          element.style.display = count > 0 ? 'flex' : 'none';
        });
        
        // Specific update for header wishlist count if it exists
        const headerWishlistCount = document.querySelector('.header-user-actions .action-btn:nth-child(2) .count');
        if (headerWishlistCount) {
          headerWishlistCount.textContent = count;
          // Also hide header count if zero
          headerWishlistCount.style.display = count > 0 ? 'flex' : 'none';
          console.log('Updated header wishlist count');
        } else {
          console.log('Header wishlist count element not found');
        }
      } catch (error) {
        console.error('Error updating wishlist count:', error);
      }
    }

    // Load products from API
    async function loadProducts() {
      try {
        // Show loading state
        productsContainer.innerHTML = '<div class="loading">Loading products...</div>';
        
        // API call
        const response = await fetch(`${API_BASE_URL}/api/products`);
        const data = await response.json();
        allProducts = data; // Store all products globally
        
        // Check if we have products
        if (!data || data.length === 0) {
          productsContainer.innerHTML = '<div class="no-products">No products available.</div>';
          return;
        }
        
        // Display the products (this handles pagination)
        displayProductsInternal(data);
      } catch (error) {
        console.error('Error loading products:', error);
        productsContainer.innerHTML = '<div class="error">Failed to load products. Please try again later.</div>';
      }
    }

    // Search products function
    function searchProducts(query) {
      query = query.toLowerCase().trim();
      if (!query) {
        displayProductsInternal(window.allProducts);
        return;
      }

      // Store the last search query for reference
      window.lastSearchQuery = query;

      const filteredProducts = window.allProducts.filter(product => {
        const title = (product.title || product.name || '').toLowerCase();
        const category = (product.category || '').toLowerCase();
        const description = (product.description || '').toLowerCase();
        
        return title.includes(query) || 
               category.includes(query) || 
               description.includes(query);
      });

      displayProductsInternal(filteredProducts);
      
      // Update results message
      const productBox = document.querySelector('.product-box');
      if (filteredProducts.length === 0) {
        productBox.innerHTML = `
          <div class="no-results">
            <p>No products found matching "${query}"</p>
          </div>
        `;
      }
      
      // Update page title to reflect search
      document.title = `Search: ${query} - BioGold`;
    }

    // Display products in the grid
    function displayProductsInternal(products) {
      // Store the function in the window object
      window.displayProductsInternal = displayProductsInternal;
      
      const productBox = document.querySelector('.product-box');
      if (!productBox) return;

      console.log('Displaying products:', products); // Debug log

      // Clear the product box
      productBox.innerHTML = '';

      // Check if we're on a desktop or mobile view
      const isDesktop = window.innerWidth >= 1024;

      // If there are no products, show a message
      if (products.length === 0) {
        productBox.innerHTML = `
          <div class="no-results">
            <p>${t('noProducts')}</p>
          </div>
        `;
        return;
      }

      // For desktop view with many products, we'll implement pagination
      const productsPerPage = isDesktop ? 8 : products.length;
      const displayedProducts = products.slice(0, productsPerPage);
      
      // Create product cards
      displayedProducts.forEach(product => {
        // Debug log for each product
        console.log('Processing product:', product);

        // Ensure we have valid data or provide defaults
        const productName = product.name || product.title || 'Product Name Not Available';
        const price = parseFloat(product.price) || 0;
        const originalPrice = product.originalPrice ? parseFloat(product.originalPrice) : (price * 1.2);
        const hasDiscount = product.originalPrice || true; // Show discount for demo purposes
        
        // Get category name from either direct property or nested object
        const categoryName = typeof product.category === 'string' 
          ? product.category 
          : (product.Category?.name || 'Uncategorized');
          
        const productId = product._id || product.id;
        
        // Handle image path - check if it's a full URL or needs to be prefixed
        let imagePath = product.image || product.imageUrl || './assets/images/products/default.jpg';
        if (imagePath && !imagePath.startsWith('http') && !imagePath.startsWith('./')) {
          // If the image path is relative to backend, prefix it with backend URL
          imagePath = `http://localhost:5000/${imagePath}`;
        }
        
        // Generate random rating between 3 and 5 stars for demo
        const rating = product.rating || Math.floor(Math.random() * 3) + 3;
        let starsHtml = '';
        for (let i = 1; i <= 5; i++) {
          if (i <= rating) {
            starsHtml += '<ion-icon name="star"></ion-icon>';
          } else {
            starsHtml += '<ion-icon name="star" class="empty"></ion-icon>';
          }
        }

        // Create a product card element
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.innerHTML = `
          ${hasDiscount ? `<div class="sale-tag">${t('sale')}</div>` : ''}
          <div class="card-action-buttons">
            <button class="action-button" onclick="addToWishlist('${productId}')" title="${t('addToWishlist')}">
              <ion-icon name="heart-outline"></ion-icon>
            </button>
            <button class="action-button" onclick="window.location.href='product-details.html?id=${productId}'" title="${t('viewDetails')}">
              <ion-icon name="eye-outline"></ion-icon>
            </button>
          </div>
          <div class="showcase">
            <div class="showcase-banner">
              <a href="product-details.html?id=${productId}" class="showcase-img-box">
                <img src="${imagePath}" 
                     alt="${productName}" 
                     class="showcase-img"
                     onerror="this.onerror=null; this.src='./assets/images/products/default.jpg';">
              </a>
            </div>
            <div class="showcase-content">
              <div class="showcase-category">${categoryName}</div>
              <a href="product-details.html?id=${productId}">
                <h3 class="showcase-title">${productName}</h3>
              </a>
              <div class="rating">
                ${starsHtml}
              </div>
              <div class="price-box">
                <p class="price">${price.toFixed(2)} TND</p>
                ${hasDiscount ? `<p class="price-original">${originalPrice.toFixed(2)} TND</p>` : ''}
              </div>
              <button class="add-cart-btn" onclick="addToCart('${productId}')">${t('addToCart')}</button>
            </div>
          </div>
        `;
        
        // Add the product card to the product box
        productBox.appendChild(productCard);
      });
      
      // Add "Load More" button for desktop view if there are more products to show
      if (isDesktop && products.length > productsPerPage) {
        const loadMoreWrapper = document.createElement('div');
        loadMoreWrapper.className = 'load-more-wrapper';
        loadMoreWrapper.innerHTML = `
          <button id="load-more-btn" class="load-more-btn">
            ${t('loadMore')}
            <ion-icon name="arrow-down-outline"></ion-icon>
          </button>
        `;
        
        // Append the load more button after the product box
        const productContainer = document.querySelector('.product-container .container');
        productContainer.appendChild(loadMoreWrapper);
        
        // Add event listener to the load more button
        document.getElementById('load-more-btn').addEventListener('click', () => {
          loadMoreProducts(products, productsPerPage);
        });
      }
      
      // Set up navigation based on screen size
      setupProductNavigation(isDesktop);
    }

    // Function to load more products
    function loadMoreProducts(allProducts, currentlyLoaded) {
      const productBox = document.querySelector('.product-box');
      if (!productBox) return;
      
      // Calculate how many more products to load
      const nextBatch = 4; // Load 4 more products
      const totalToShow = Math.min(currentlyLoaded + nextBatch, allProducts.length);
      
      // Get the next batch of products
      const nextProducts = allProducts.slice(currentlyLoaded, totalToShow);
      
      // If we've loaded all products, remove the load more button
      if (totalToShow >= allProducts.length) {
        const loadMoreBtn = document.getElementById('load-more-btn');
        if (loadMoreBtn) {
          loadMoreBtn.parentElement.remove();
        }
      }
      
      // Append the next batch of products to the product box
      nextProducts.forEach(product => {
        // Create card (duplicate code from displayProducts)
        // This is simplified for the example - you might want to refactor to avoid duplication
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        
        // Process product data (same as in displayProducts)
        const productName = product.name || product.title || 'Product Name Not Available';
        const price = parseFloat(product.price) || 0;
        const originalPrice = product.originalPrice ? parseFloat(product.originalPrice) : (price * 1.2);
        const hasDiscount = product.originalPrice || true;
        const categoryName = typeof product.category === 'string' 
          ? product.category 
          : (product.Category?.name || 'Uncategorized');
        const productId = product._id || product.id;
        
        let imagePath = product.image || product.imageUrl || './assets/images/products/default.jpg';
        if (imagePath && !imagePath.startsWith('http') && !imagePath.startsWith('./')) {
          imagePath = `http://localhost:5000/${imagePath}`;
        }
        
        const rating = product.rating || Math.floor(Math.random() * 3) + 3;
        let starsHtml = '';
        for (let i = 1; i <= 5; i++) {
          if (i <= rating) {
            starsHtml += '<ion-icon name="star"></ion-icon>';
          } else {
            starsHtml += '<ion-icon name="star" class="empty"></ion-icon>';
          }
        }
        
        productCard.innerHTML = `
          ${hasDiscount ? `<div class="sale-tag">${t('sale')}</div>` : ''}
          <div class="card-action-buttons">
            <button class="action-button" onclick="addToWishlist('${productId}')" title="${t('addToWishlist')}">
              <ion-icon name="heart-outline"></ion-icon>
            </button>
            <button class="action-button" onclick="window.location.href='product-details.html?id=${productId}'" title="${t('viewDetails')}">
              <ion-icon name="eye-outline"></ion-icon>
            </button>
        </div>
          <div class="showcase">
            <div class="showcase-banner">
              <a href="product-details.html?id=${productId}" class="showcase-img-box">
                <img src="${imagePath}" 
                     alt="${productName}" 
                     class="showcase-img"
                     onerror="this.onerror=null; this.src='./assets/images/products/default.jpg';">
              </a>
            </div>
            <div class="showcase-content">
              <div class="showcase-category">${categoryName}</div>
              <a href="product-details.html?id=${productId}">
                <h3 class="showcase-title">${productName}</h3>
              </a>
              <div class="rating">
                ${starsHtml}
              </div>
              <div class="price-box">
                <p class="price">${price.toFixed(2)} TND</p>
                ${hasDiscount ? `<p class="price-original">${originalPrice.toFixed(2)} TND</p>` : ''}
              </div>
              <button class="add-cart-btn" onclick="addToCart('${productId}')">${t('addToCart')}</button>
            </div>
          </div>
        `;
        
        productBox.appendChild(productCard);
      });
      
      // Update the load more button to load the next batch
      const loadMoreBtn = document.getElementById('load-more-btn');
      if (loadMoreBtn) {
        loadMoreBtn.onclick = () => loadMoreProducts(allProducts, totalToShow);
      }
    }

    // Function to set up product navigation (scroll or pagination)
    function setupProductNavigation(isDesktop) {
      // Remove existing navigation
      const existingNav = document.querySelector('.product-navigation');
      if (existingNav) {
        existingNav.remove();
      }
      
      const productContainer = document.querySelector('.product-container .container');
      
      if (!isDesktop) {
        // Add scroll buttons for mobile
        const navDiv = document.createElement('div');
        navDiv.className = 'product-navigation';
        navDiv.innerHTML = `
          <button class="nav-btn prev-btn" onclick="scrollProducts('left')">
            <ion-icon name="chevron-back-outline"></ion-icon>
          </button>
          <button class="nav-btn next-btn" onclick="scrollProducts('right')">
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </button>
        `;
        productContainer.appendChild(navDiv);
      }
    }

    // Listen for window resize to adjust product layout
    window.addEventListener('resize', () => {
      const isDesktop = window.innerWidth >= 1024;
      setupProductNavigation(isDesktop);
    });

    // Function to scroll products horizontally
    function scrollProducts(direction) {
      const productBox = document.querySelector('.product-box');
      const scrollAmount = 300;
      if (direction === 'left') {
        productBox.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
      } else {
        productBox.scrollBy({ left: scrollAmount, behavior: 'smooth' });
      }
    }

    // Add to cart function
    async function addToCart(productId) {
      try {
        const response = await fetch(`http://localhost:5000/api/products/${productId}`);
        if (!response.ok) {
          throw new Error('Product not found');
        }
        const product = await response.json();
        console.log('Product to add to cart:', product); // Debug log
        
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const existingItem = cart.find(item => item.productId === productId);
        
        // Ensure image path is properly formatted
        let imagePath = product.image || product.imageUrl || './assets/images/products/default.jpg';
        console.log('Original image path:', imagePath); // Debug log
        
        if (imagePath && !imagePath.startsWith('http') && !imagePath.startsWith('./')) {
          imagePath = `http://localhost:5000/${imagePath}`;
        }
        console.log('Formatted image path:', imagePath); // Debug log
        
        // Ensure product name is properly set
        const productName = product.name || product.title || 'Unknown Product';
        console.log('Product name:', productName); // Debug log
        
        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({
            productId,
            name: productName,
            price: parseFloat(product.price) || 0,
            image: imagePath,
            quantity: 1
          });
        }
        
        localStorage.setItem('cart', JSON.stringify(cart));
        console.log('Updated cart:', cart); // Debug log
        updateCartCount();
        
        // Show success message
        const toast = document.createElement('div');
        toast.className = 'toast';
        toast.textContent = 'Product added to cart!';
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 2000);
      } catch (error) {
        console.error('Error adding to cart:', error);
        alert('Failed to add product to cart. Please try again.');
      }
    }

    // Add to wishlist function
    function addToWishlist(productId) {
      console.log('Adding to wishlist, product ID:', productId);
      
      if (!productId) {
        console.error('No product ID provided to addToWishlist function');
        showToast('Error: Product ID not found', 'error');
        return;
      }
      
      // Look for the product in allProducts
      let product = null;
      
      // Find the product in the global products array
      if (window.allProducts && window.allProducts.length > 0) {
        product = window.allProducts.find(p => 
          p._id === productId || 
          p.id === productId || 
          p.productId === productId
        );
      }
      
      if (!product) {
        console.error('Product not found in allProducts array for ID:', productId);
        
        // Try to fetch the product directly from the API
        fetch(`http://localhost:5000/api/products/${productId}`)
          .then(response => {
            if (!response.ok) throw new Error('Product not found on server');
            return response.json();
          })
          .then(fetchedProduct => {
            console.log('Product fetched directly from API:', fetchedProduct);
            addProductToWishlist(fetchedProduct, productId);
          })
          .catch(error => {
            console.error('Error fetching product from API:', error);
            showToast('Error: Could not find product details', 'error');
          });
      } else {
        // If we found the product in allProducts, add it to wishlist
        addProductToWishlist(product, productId);
      }
    }
    
    // Helper function to add a product to the wishlist
    function addProductToWishlist(product, productId) {
      // Get the existing wishlist
      let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
      
      // Use productId from parameter if product doesn't have _id or id
      const finalProductId = product._id || product.id || productId;
      
      // Check if product is already in wishlist
      const isInWishlist = wishlist.some(item => 
        item.productId === finalProductId || 
        (product._id && item.productId === product._id) || 
        (product.id && item.productId === product.id)
      );
      
      if (!isInWishlist) {
        // Format the image path correctly
        let imagePath = product.image || product.imageUrl || './assets/images/products/default.jpg';
        if (imagePath && !imagePath.startsWith('http') && !imagePath.startsWith('./')) {
          imagePath = `http://localhost:5000/${imagePath}`;
        }
        
        // Prepare wishlist item with consistent data format
        const wishlistItem = {
          productId: finalProductId,
          name: product.name || product.title || 'Unknown Product',
          price: parseFloat(product.price) || 0,
          image: imagePath,
          description: product.description || '',
          category: typeof product.category === 'string' ? product.category : (product.Category?.name || 'Uncategorized')
        };
        
        console.log('Adding item to wishlist:', wishlistItem);
        
        wishlist.push(wishlistItem);
        localStorage.setItem('wishlist', JSON.stringify(wishlist));
        
        // Update wishlist count
        updateWishlistCount();
        
        // Show feedback to user
        showToast('Product added to wishlist!', 'success');
      } else {
        // If already in wishlist, show a different message
        showToast('Product already in wishlist', 'info');
      }
    }

    // Function to view product details
    function viewProductDetails(productId) {
      window.location.href = `product-details.html?id=${productId}`;
    }
    
    // Function to clear wishlist (can be called from console)
    function clearWishlist() {
      localStorage.setItem('wishlist', JSON.stringify([]));
      wishlist = [];
      updateWishlistCount();
      console.log('Wishlist cleared');
      
      // Show feedback
        const toast = document.createElement('div');
        toast.className = 'toast';
      toast.textContent = 'Wishlist cleared!';
        document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
        
      return 'Wishlist has been cleared successfully';
    }

    // Make it available in the window object
    window.clearWishlist = clearWishlist;

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      loadProducts();
      updateCartCount();
      updateWishlistCount();
      
      // Apply initial translations
      if (typeof translatePage === 'function') {
        translatePage();
      }
      
      // Load categories for the dropdown
      loadCategories();

      // Load existing wishlist from localStorage
      const savedWishlist = localStorage.getItem('wishlist');
      if (savedWishlist) {
        wishlist = JSON.parse(savedWishlist);
        updateWishlistCount();
      }

      // Add search functionality
      const searchField = document.querySelector('.search-field');
      const searchBtn = document.querySelector('.search-btn');

      // Search on button click
      searchBtn.addEventListener('click', () => {
        searchProducts(searchField.value);
      });

      // Search on enter key
      searchField.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          searchProducts(searchField.value);
        }
      });

      // Real-time search (optional)
      searchField.addEventListener('input', (e) => {
        searchProducts(e.target.value);
      });

      // Newsletter form submission
      document.querySelector('.footer-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = this.querySelector('input[type="email"]').value;
        alert('Thank you for subscribing! We will keep you updated.');
        this.reset();
      });

      // Contact form submission 
      async function handleContactSubmit(event) {
        event.preventDefault();
        
        // Get form values
        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const message = document.getElementById('message').value.trim();
        
        // Validate input
        if (!name || !email || !message) {
          alert('Please fill in all fields');
          return;
        }
        
        // Show loading state
        const submitBtn = event.target.querySelector('.submit-btn');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<ion-icon name="hourglass-outline"></ion-icon> Sending...';
        submitBtn.disabled = true;
        
        try {
          // Send data to server
          const response = await fetch('http://localhost:5000/api/contacts', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({ name, email, message })
          });
          
          const data = await response.json();
          
          if (!response.ok) {
            throw new Error(data.error || 'Something went wrong');
          }
          
          // Show success message
          alert('Thank you for your message! We will get back to you soon.');
          
          // Reset form
          event.target.reset();
        } catch (error) {
          console.error('Error submitting contact form:', error);
          alert('There was a problem sending your message. Please try again later.');
        } finally {
          // Restore button state
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }
      }
      });

      // Add these functions to your existing script section
      async function loadCategories() {
        try {
          const response = await fetch(`${API_BASE_URL}/api/categories`);
          const categories = await response.json();
        
        console.log(`Loaded ${categories.length} categories`);
        
        // Clear existing categories first
          const categoryDropdown = document.getElementById('categoryDropdown');
        const mobileCategoryList = document.getElementById('mobileCategoryList');
        
        if (categoryDropdown) categoryDropdown.innerHTML = '';
        if (mobileCategoryList) mobileCategoryList.innerHTML = '';
        
        // Add "All Products" option
        if (categoryDropdown) {
          const allProductsItem = document.createElement('li');
          allProductsItem.className = 'dropdown-item';
          allProductsItem.innerHTML = `<a href="#" class="active" onclick="loadAllProducts(); return false;">${t('products')}</a>`;
          categoryDropdown.appendChild(allProductsItem);
        }
        
        // Add "All Products" option to mobile menu
        if (mobileCategoryList) {
          const mobileAllProductsItem = document.createElement('li');
          mobileAllProductsItem.className = 'mobile-category-item';
          mobileAllProductsItem.innerHTML = `<a href="#" class="active" onclick="loadAllProducts(); hideCategories(); return false;">${t('products')}</a>`;
          mobileCategoryList.appendChild(mobileAllProductsItem);
        }
        
        // Add categories to dropdown and mobile list
          categories.forEach(category => {
          // Ensure category ID is a number
          const categoryId = parseInt(category.id || category._id, 10);
          
          // Add to desktop dropdown
          if (categoryDropdown) {
            const listItem = document.createElement('li');
            listItem.className = 'dropdown-item';
            
            const link = document.createElement('a');
            link.href = '#';
            link.textContent = category.name;
            // Pass the numeric categoryId as the first parameter
            link.onclick = function() {
              filterByCategory(categoryId, category.name);
              return false;
            };
            
            listItem.appendChild(link);
            categoryDropdown.appendChild(listItem);
          }
          
          // Add to mobile category list
          if (mobileCategoryList) {
            const mobileCategoryItem = document.createElement('li');
            mobileCategoryItem.className = 'mobile-category-item';
            
            const mobileLink = document.createElement('a');
            mobileLink.href = '#';
            mobileLink.textContent = category.name;
            mobileLink.onclick = function() {
              filterByCategory(categoryId, category.name);
              hideCategories();
              return false;
            };
            
            mobileCategoryItem.appendChild(mobileLink);
            mobileCategoryList.appendChild(mobileCategoryItem);
          }
          
          // For debugging
          console.log(`Added category: ${category.name} (ID: ${categoryId}, type: ${typeof categoryId})`);
        });
        
        // Set up mobile category menu functionality
        setupMobileCategoryMenu();
        
        } catch (error) {
          console.error('Error loading categories:', error);
        // Add a fallback option
        const categoryDropdown = document.getElementById('categoryDropdown');
        if (categoryDropdown) {
          categoryDropdown.innerHTML = `<li class="dropdown-item"><a href="#" onclick="loadAllProducts(); return false;">${t('products')}</a></li>`;
        }
        
        const mobileCategoryList = document.getElementById('mobileCategoryList');
        if (mobileCategoryList) {
          mobileCategoryList.innerHTML = `<li class="mobile-category-item"><a href="#" onclick="loadAllProducts(); hideCategories(); return false;">${t('products')}</a></li>`;
        }
      }
    }
    
    // Setup mobile category menu functionality
    function setupMobileCategoryMenu() {
      const mobileCategoriesBtn = document.getElementById('mobile-categories-btn');
      const mobileCategoryMenu = document.getElementById('mobileCategoryMenu');
      const mobileCategoryOverlay = document.getElementById('mobileCategoryOverlay');
      const mobileCategoryClose = document.querySelector('.mobile-category-close');
      
      if (mobileCategoriesBtn) {
        mobileCategoriesBtn.addEventListener('click', function(e) {
          e.preventDefault();
          showCategories();
        });
      }
      
      if (mobileCategoryClose) {
        mobileCategoryClose.addEventListener('click', hideCategories);
      }
      
      if (mobileCategoryOverlay) {
        mobileCategoryOverlay.addEventListener('click', hideCategories);
      }
    }
    
    // Show mobile categories
    function showCategories() {
      const mobileCategoryMenu = document.getElementById('mobileCategoryMenu');
      const mobileCategoryOverlay = document.getElementById('mobileCategoryOverlay');
      
      if (mobileCategoryMenu) mobileCategoryMenu.classList.add('active');
      if (mobileCategoryOverlay) mobileCategoryOverlay.classList.add('active');
      
      // Prevent body scrolling
      document.body.style.overflow = 'hidden';
    }
    
    // Hide mobile categories
    function hideCategories() {
      const mobileCategoryMenu = document.getElementById('mobileCategoryMenu');
      const mobileCategoryOverlay = document.getElementById('mobileCategoryOverlay');
      
      if (mobileCategoryMenu) mobileCategoryMenu.classList.remove('active');
      if (mobileCategoryOverlay) mobileCategoryOverlay.classList.remove('active');
      
      // Restore body scrolling
      document.body.style.overflow = '';
    }

    // Global functions for category handling
      async function loadAllProducts() {
        try {
        // Instead of making a new API call, use the existing global variable
        if (window.allProducts && window.allProducts.length > 0) {
          console.log('Using existing products from global variable:', window.allProducts.length);
          // Make sure global allProducts variable is in sync with window.allProducts
          allProducts = window.allProducts;
          displayProductsInternal(window.allProducts);
        } else {
          // Fallback to API call if global variable is empty
          console.log('Global products not available, making API call');
          const response = await fetch('http://localhost:5000/api/products');
          const products = await response.json();
          
          console.log('All products loaded from API:', products.length);
          window.allProducts = products; // Update the window variable
          allProducts = products; // Update the global variable
          displayProductsInternal(products);
        }
        
          // Update active category visual
          document.querySelectorAll('.dropdown-item a').forEach(a => a.classList.remove('active'));
        const firstDropdownItem = document.querySelector('.dropdown-item:first-child a');
        if (firstDropdownItem) firstDropdownItem.classList.add('active');
        
        // Update mobile category visual
        document.querySelectorAll('.mobile-category-item a').forEach(a => a.classList.remove('active'));
        const firstMobileItem = document.querySelector('.mobile-category-item:first-child a');
        if (firstMobileItem) firstMobileItem.classList.add('active');
        
        // Update the product grid title if it exists
        const gridTitle = document.querySelector('.product-grid-title');
        if (gridTitle) {
          gridTitle.textContent = t('ourProducts');
        }
        
        // Scroll to the products section
        const productsSection = document.getElementById('products');
        if (productsSection) productsSection.scrollIntoView({ behavior: 'smooth' });
        } catch (error) {
        console.error('Error loading all products:', error);
        alert(t('errorLoading'));
      }
    }

    // Add internal filterByCategory function
    async function filterByCategoryInternal(categoryId, categoryName) {
      // Store the function in the window object
      window.filterByCategoryInternal = filterByCategoryInternal;
      
      try {
        // Ensure categoryId is a number
        categoryId = Number(categoryId);
        
        console.log(`Filtering by category: ID=${categoryId}, Name=${categoryName}, Type=${typeof categoryId}`);
        
        // Use category parameter in API request for server-side filtering
        const response = await fetch(`http://localhost:5000/api/products?categoryId=${categoryId}`);
        let products = await response.json();
        
        console.log(`Server returned ${products.length} products for category ID ${categoryId}`);
        
        // As a fallback, filter on client-side if server returned all products
        if (products.length > 0 && !products[0].filteredByCategory) {
          console.log('Server did not filter products, applying client-side filter');
          
          // Filter products from the global products list
          if (window.allProducts && window.allProducts.length > 0) {
            const originalCount = window.allProducts.length;
            products = window.allProducts.filter(product => {
              // Handle different formats of CategoryId
              const productCategoryId = typeof product.CategoryId === 'string' 
                ? parseInt(product.CategoryId, 10) 
                : Number(product.CategoryId);
                
              const productCategoryIdLower = typeof product.categoryId === 'string'
                ? parseInt(product.categoryId, 10)
                : Number(product.categoryId);
                
              const nestedCategoryId = product.Category 
                ? (typeof product.Category.id === 'string' 
                    ? parseInt(product.Category.id, 10) 
                    : Number(product.Category.id))
                : null;
              
              return (
                productCategoryId === categoryId || 
                productCategoryIdLower === categoryId ||
                nestedCategoryId === categoryId
              );
            });
            
            console.log(`Client-side filtering: ${originalCount} â†’ ${products.length} products`);
          }
        }
        
        // Display the filtered products
        if (products.length === 0) {
          console.warn(`No products found in category "${categoryName}" (ID: ${categoryId})`);
          // Add a message to the product area instead of showing nothing
          const productBox = document.querySelector('.product-box');
          if (productBox) {
            productBox.innerHTML = `
              <div class="no-results">
                <h3>${t('noResults')} "${categoryName}"</h3>
                <p>Try selecting a different category or go back to all products.</p>
                <button onclick="loadAllProducts()" class="btn">${t('products')}</button>
              </div>
            `;
          }
        } else {
          displayProductsInternal(products);
        }
          
          // Update active category visual
          document.querySelectorAll('.dropdown-item a').forEach(a => a.classList.remove('active'));
        
        // Find and activate the category link in desktop view
        const categoryLinks = document.querySelectorAll('.dropdown-item a');
        let categoryLinkFound = false;
        
        for (const link of categoryLinks) {
          if (link.textContent === categoryName) {
            link.classList.add('active');
            categoryLinkFound = true;
            break;
          }
        }
        
        // Update active category in mobile view
        document.querySelectorAll('.mobile-category-item a').forEach(a => a.classList.remove('active'));
        
        // Find and activate the mobile category link
        const mobileCategoryLinks = document.querySelectorAll('.mobile-category-item a');
        let mobileCategoryLinkFound = false;
        
        for (const link of mobileCategoryLinks) {
          if (link.textContent === categoryName) {
            link.classList.add('active');
            mobileCategoryLinkFound = true;
            break;
          }
        }
        
        if (!categoryLinkFound) {
          console.warn(`Could not find category link for "${categoryName}"`);
        }
          
          // Update the product grid title
          const gridTitle = document.querySelector('.product-grid-title');
          if (gridTitle) {
            gridTitle.textContent = categoryName;
          }
        
        // Scroll to the products section
        const productsSection = document.getElementById('products');
        if (productsSection) productsSection.scrollIntoView({ behavior: 'smooth' });
        } catch (error) {
        console.error('Error filtering by category:', error);
        alert(t('errorLoading'));
      }
    }

    // Add hideCategoriesInternal function
    function hideCategoriesInternal() {
      // Store the function in the window object
      window.hideCategoriesInternal = hideCategoriesInternal;
      
      const mobileCategoryMenu = document.getElementById('mobileCategoryMenu');
      const mobileCategoryOverlay = document.getElementById('mobileCategoryOverlay');
      
      if (mobileCategoryMenu) mobileCategoryMenu.classList.remove('active');
      if (mobileCategoryOverlay) mobileCategoryOverlay.classList.remove('active');
      
      // Restore body scrolling
      document.body.style.overflow = '';
    }
    
    // Add global wrapper functions
    function filterByCategory(categoryId, categoryName) {
      // Make this a wrapper for the original function to maintain behavior
      if (window.filterByCategoryInternal) {
        window.filterByCategoryInternal(categoryId, categoryName);
      } else {
        console.error('Internal filter function not available');
      }
    }

    function hideCategories() {
      // Make this a wrapper for the original function
      if (window.hideCategoriesInternal) {
        window.hideCategoriesInternal();
      }
    }

    // Global display products function
    function displayProducts(products) {
      // Make this a wrapper for the original function
      if (window.displayProductsInternal) {
        window.displayProductsInternal(products);
      } else {
        console.error('Internal display function not available');
      }
    }

    // Function to reset wishlist if it shows incorrectly
    function resetWishlist() {
      localStorage.setItem('wishlist', JSON.stringify([]));
      updateWishlistCount();
      console.log('Wishlist has been reset');
      
      // Show feedback
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = 'Wishlist has been reset!';
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
      return 'Wishlist has been reset successfully';
    }
    
    // Make it available in the window object
    window.resetWishlist = resetWishlist;

    // Function to show toast notification
    function showToast(message, type = 'success') {
      // Remove any existing toasts
      const existingToasts = document.querySelectorAll('.toast');
      existingToasts.forEach(toast => toast.remove());
      
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      // Add appropriate icon based on type
      let icon;
      if (type === 'success') {
        icon = 'checkmark-circle-outline';
      } else if (type === 'error') {
        icon = 'alert-circle-outline';
      } else if (type === 'warning') {
        icon = 'warning-outline';
      } else {
        icon = 'information-circle-outline';
      }
      
      toast.innerHTML = `
        <ion-icon name="${icon}"></ion-icon>
        <span>${message}</span>
      `;
      
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 2000);
    }
  </script>

  <style>
    /* Product Grid and Card Styles */
    .product-container {
      padding: 40px 0;
      background: var(--cultured);
    }

    .section-title {
      text-align: center;
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 25px;
      color: var(--eerie-black);
    }

    .product-box {
      display: flex;
      flex-wrap: nowrap;
      overflow-x: auto;
      gap: 15px;
      margin: 20px 0;
      padding: 0 15px;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* Firefox */
    }

    .product-box::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Edge */
    }

    .product-card {
      background: var(--white);
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      overflow: hidden;
      min-width: 280px;
      max-width: 320px;
      flex: 0 0 auto;
      position: relative;
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }

    /* Quick action buttons for desktop view */
    .card-action-buttons {
      position: absolute;
      top: 15px;
      right: 15px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 10;
      opacity: 0;
      transform: translateX(10px);
      transition: all 0.3s ease;
    }

    .product-card:hover .card-action-buttons {
      opacity: 1;
      transform: translateX(0);
    }

    .action-button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--white);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
    }

    .action-button:hover {
      background: var(--salmon-pink);
      color: var(--white);
    }

    .sale-tag {
      position: absolute;
      top: 0;
      left: 0;
      background: #333;
      color: white;
      padding: 6px 12px;
      font-weight: 600;
      font-size: 0.85rem;
      z-index: 5;
      clip-path: polygon(0 0, 100% 0, 85% 100%, 0% 100%);
      width: 65px;
      text-align: center;
    }

    .showcase {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .showcase-banner {
      position: relative;
      width: 100%;
      height: 280px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f9f9f9;
      overflow: hidden;
    }

    .showcase-img-box {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .showcase-img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      transition: transform 0.3s ease;
    }

    .showcase:hover .showcase-img {
      transform: scale(1.05);
    }

    .showcase-content {
      padding: 20px;
      display: flex;
      flex-direction: column;
      flex: 1;
      gap: 8px;
    }

    .showcase-category {
      display: inline-block;
      color: var(--salmon-pink);
      font-size: 0.85rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 1px;
      background-color: rgba(242, 97, 103, 0.1);
      padding: 4px 10px;
      border-radius: 12px;
      margin-bottom: 5px;
    }

    .showcase-title {
      color: var(--eerie-black);
      font-size: 1.2rem;
      font-weight: 600;
      text-transform: capitalize;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      margin-bottom: 5px;
    }

    .rating {
      display: flex;
      align-items: center;
      gap: 2px;
      margin-bottom: 8px;
    }

    .rating ion-icon {
      color: #FFD700;
      font-size: 1.1rem;
    }

    .rating .empty {
      color: #e0e0e0;
    }

    .price-box {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: auto;
    }

    .price {
      color: var(--eerie-black);
      font-size: 1.25rem;
      font-weight: 700;
    }

    .price-original {
      color: #999;
      font-size: 1rem;
      text-decoration: line-through;
    }

    .add-cart-btn {
      width: 100%;
      padding: 12px;
      margin-top: 15px;
      background: var(--salmon-pink);
      color: var(--white);
      font-size: 0.9rem;
      font-weight: 500;
      text-transform: uppercase;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
      letter-spacing: 0.5px;
    }

    .add-cart-btn:hover {
      background: var(--eerie-black);
    }

    .product-navigation {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }

    .nav-btn {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--white);
      border: none;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .nav-btn:hover {
      background: var(--salmon-pink);
      color: var(--white);
    }

    /* Responsive Design */
    @media screen and (min-width: 768px) {
      .product-box {
        gap: 20px;
        padding: 0 20px;
      }

      .product-card {
        min-width: 300px;
      }
      
      .showcase-banner {
        height: 300px;
      }
    }

    @media screen and (min-width: 1024px) {
      .product-box {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        overflow-x: visible;
        flex-wrap: wrap;
      }
      
      .product-card {
        min-width: auto;
        max-width: 100%;
        flex: none;
        width: 100%;
      }
      
      .product-navigation {
        display: none; /* Hide navigation buttons for desktop */
      }

      /* Enhanced card design for desktop */
      .product-card {
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .showcase {
        height: 100%;
      }

      .showcase-content {
        display: flex;
        flex-direction: column;
        flex: 1;
      }

      .showcase-title {
        margin-bottom: 8px;
        font-size: 1.1rem;
        line-height: 1.4;
        max-height: 3em;
        overflow: hidden;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        white-space: normal;
      }

      .price-box {
        margin: 12px 0;
      }
    }

    @media screen and (min-width: 1200px) {
      .product-box {
        grid-template-columns: repeat(4, 1fr);
        gap: 25px;
      }
    }

    @media screen and (max-width: 767px) {
      .product-container {
        padding: 30px 0;
      }

      .product-card {
        min-width: 240px;
        max-width: 280px;
      }

      .showcase-banner {
        height: 240px;
      }

      .showcase-content {
        padding: 15px;
      }
      
      .showcase-title {
        font-size: 1.1rem;
      }
      
      .price {
        font-size: 1.2rem;
      }

      .add-cart-btn {
        padding: 10px;
        font-size: 0.85rem;
      }
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--salmon-pink);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.7s forwards;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .toast.error {
      background-color: #f44336;
    }
    
    .toast.success {
      background-color: #4caf50;
    }
    
    .toast.warning {
      background-color: #ff9800;
    }
    
    .toast ion-icon {
      font-size: 1.2rem;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes fadeOut {
      from {
        opacity: 1;
      }
      to {
        opacity: 0;
      }
    }

    /* Footer Styles */
    .footer-nav {
      padding: 60px 0;
      background: var(--cultured);
    }

    .footer-nav-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 40px;
    }

    .footer-nav-item {
      padding: 0 15px;
    }

    .nav-title {
      color: var(--eerie-black);
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 20px;
      position: relative;
      padding-bottom: 10px;
    }

    .nav-title::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: 0;
      width: 50px;
      height: 2px;
      background: var(--salmon-pink);
    }

    .footer-links {
      list-style: none;
      padding: 0;
    }

    .footer-links li {
      margin-bottom: 12px;
    }

    .footer-links a {
      color: var(--sonic-silver);
      text-decoration: none;
      transition: color 0.3s ease;
      display: inline-flex;
      align-items: center;
    }

    .footer-links a:hover {
      color: var(--salmon-pink);
      padding-left: 5px;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
      color: var(--sonic-silver);
    }

    .contact-item ion-icon {
      color: var(--salmon-pink);
      font-size: 1.3rem;
    }

    .footer-form {
      margin-top: 20px;
      position: relative;
    }

    .footer-form input {
      width: 100%;
      padding: 12px;
      padding-right: 40px;
      border: 1px solid #ddd;
      border-radius: 6px;
      outline: none;
      transition: border-color 0.3s ease;
    }

    .footer-form input:focus {
      border-color: var(--salmon-pink);
    }

    .submit-btn {
      background: var(--salmon-pink);
      color: var(--white);
      border: none;
      padding: 12px 25px;
      border-radius: 6px;
      margin-top: 10px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .submit-btn:hover {
      background: var(--eerie-black);
    }

    .social-links {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }

    .footer-link {
      color: var(--sonic-silver);
      font-size: 1.5rem;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: var(--white);
    }

    .footer-link:hover {
      color: var(--white);
      background: var(--salmon-pink);
      transform: translateY(-3px);
    }

    .footer-bottom {
      padding: 20px 0;
      background: var(--eerie-black);
      color: var(--white);
      text-align: center;
    }

    .copyright {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    .copyright ion-icon {
      color: var(--salmon-pink);
      font-size: 1.2rem;
    }

    .copyright a {
      color: var(--salmon-pink);
      text-decoration: none;
    }

    /* Responsive Design */
    @media screen and (max-width: 768px) {
      .footer-nav {
        padding: 40px 0;
      }

      .footer-nav-list {
        gap: 30px;
      }

      .nav-title {
        font-size: 1.2rem;
        margin-bottom: 15px;
      }

      .footer-form input,
      .submit-btn {
        padding: 10px;
      }
    }

    @media screen and (max-width: 480px) {
      .footer-nav-list {
        grid-template-columns: 1fr;
        gap: 25px;
      }

      .footer-nav-item {
        text-align: center;
      }

      .nav-title::after {
        left: 50%;
        transform: translateX(-50%);
      }

      .footer-links a {
        justify-content: center;
      }

      .contact-item {
        justify-content: center;
      }

      .social-links {
        justify-content: center;
      }
    }

    /* Add these styles for search functionality */
    .no-results {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px;
      background: var(--white);
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .no-results p {
      color: var(--sonic-silver);
      font-size: 1.1rem;
    }

    .search-field {
      padding-right: 40px;
    }

    .search-btn {
      cursor: pointer;
      transition: color 0.3s ease;
    }

    .search-btn:hover {
      color: var(--salmon-pink);
    }

    /* Highlight search matches (optional) */
    .product-title mark {
      background: rgba(255, 99, 71, 0.2);
      color: inherit;
    }

    /* Add these styles to your existing CSS */
    .dropdown-item a {
      display: block;
      padding: 8px 16px;
      color: var(--eerie-black);
      font-size: var(--fs-6);
      text-transform: capitalize;
      transition: var(--transition-timing);
    }

    .dropdown-item a:hover,
    .dropdown-item a.active {
      color: var(--salmon-pink);
    }

    .product-grid-title {
      margin-bottom: 20px;
      font-size: var(--fs-3);
      font-weight: var(--weight-600);
      text-transform: capitalize;
    }

    /* Add these styles for the category dropdown */
    .menu-category {
      position: relative;
    }

    .dropdown-list {
      position: absolute;
      top: 100%;
      left: 0;
      width: 200px;
      padding: 20px 0;
      border-radius: 0 0 6px 6px;
      background: var(--white);
      box-shadow: 0 3px 5px hsla(0, 0%, 0%, 0.1);
      z-index: 100;
      display: none;
      border: 1px solid var(--cultured);
    }

    .menu-category:hover .dropdown-list {
      display: block;
    }

    .dropdown-item a {
      padding: 10px 25px;
      color: var(--sonic-silver);
      font-size: var(--fs-6);
      font-weight: var(--weight-300);
      text-transform: capitalize;
      display: block;
      transition: 0.3s ease;
    }

    .dropdown-item a:hover {
      color: var(--salmon-pink);
      background: var(--cultured);
    }

    /* Contact Section Styles */
    .contact-section {
      padding: 60px 0;
      background-color: #f9f9f9;
    }

    .section-subtitle {
      text-align: center;
      color: var(--sonic-silver);
      margin-bottom: 30px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }

    .contact-container {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 30px;
      max-width: 1100px;
      margin: 0 auto;
    }

    .contact-info-box {
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .contact-info-item {
      display: flex;
      align-items: flex-start;
      gap: 15px;
    }

    .contact-info-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 45px;
      height: 45px;
      background-color: var(--salmon-pink);
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      flex-shrink: 0;
    }

    .contact-info-text h3 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 5px;
      color: var(--eerie-black);
    }

    .contact-info-text p {
      color: var(--sonic-silver);
      font-size: 0.95rem;
    }

    .contact-social {
      margin-top: 15px;
    }

    .contact-social h3 {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--eerie-black);
    }

    .contact-social-links {
      display: flex;
      gap: 12px;
    }

    .contact-social-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 38px;
      height: 38px;
      background-color: #f5f5f5;
      border-radius: 50%;
      color: var(--sonic-silver);
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }

    .contact-social-link:hover {
      background-color: var(--salmon-pink);
      color: white;
      transform: translateY(-3px);
    }

    .contact-form {
      background-color: white;
      padding: 40px;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 500;
      margin-bottom: 8px;
      color: var(--eerie-black);
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #e1e1e1;
      border-radius: 6px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--salmon-pink);
      box-shadow: 0 0 0 3px rgba(242, 97, 103, 0.1);
    }

    .form-group textarea {
      height: 150px;
      resize: vertical;
    }

    .submit-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      padding: 14px;
      background-color: var(--salmon-pink);
      color: white;
      font-size: 1rem;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .submit-btn ion-icon {
      font-size: 1.1rem;
    }

    .submit-btn:hover {
      background-color: var(--eerie-black);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .submit-btn:active {
      transform: translateY(0);
    }

    @media (max-width: 768px) {
      .contact-container {
        grid-template-columns: 1fr;
      }
      
      .contact-form,
      .contact-info-box {
        padding: 25px;
      }
    }

    /* Mobile-specific navigation */
    .mobile-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: white;
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
      z-index: 100;
    }

    .mobile-nav a {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #777;
      text-decoration: none;
      font-size: 0.7rem;
    }

    .mobile-nav a.active {
      color: var(--salmon-pink);
    }

    .mobile-nav ion-icon {
      font-size: 1.3rem;
      margin-bottom: 3px;
    }

    .mobile-nav-badge {
      position: absolute;
      top: 0;
      right: 28%;
      background: var(--salmon-pink);
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.7rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @media screen and (min-width: 768px) {
      .mobile-nav {
        display: none;
      }
    }

    /* Add space at the bottom on mobile for the navigation bar */
    @media screen and (max-width: 767px) {
      body {
        padding-bottom: 65px;
      }
    }
    
    /* Mobile Category Menu Styles */
    .mobile-category-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }
    
    .mobile-category-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    
    .mobile-category-menu {
      position: fixed;
      bottom: -100%;
      left: 0;
      width: 100%;
      max-height: 70vh;
      background: white;
      border-radius: 20px 20px 0 0;
      z-index: 1000;
      transition: all 0.4s ease;
      overflow-y: auto;
      box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.1);
    }
    
    .mobile-category-menu.active {
      bottom: 0;
    }
    
    .mobile-category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #eee;
    }
    
    .mobile-category-header h3 {
      font-size: 1.2rem;
      color: var(--eerie-black);
      margin: 0;
    }
    
    .mobile-category-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--sonic-silver);
      cursor: pointer;
    }
    
    .mobile-category-list {
      list-style: none;
      padding: 10px;
      margin: 0;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }
    
    .mobile-category-item {
      padding: 15px;
      background: #f9f9f9;
      border-radius: 8px;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .mobile-category-item:hover,
    .mobile-category-item.active {
      background: var(--salmon-pink);
      color: white;
    }
    
    .mobile-category-item a {
      color: var(--eerie-black);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
      display: block;
    }
    
    .mobile-category-item:hover a,
    .mobile-category-item.active a {
      color: white;
    }
    
    @media screen and (min-width: 768px) {
      .mobile-category-menu,
      .mobile-category-overlay {
        display: none;
      }
    }

    /* Quick Links Section Styles */
    .footer-links {
      padding: 0;
      margin: 0;
      background: transparent;
    }

    .footer-link-list {
      list-style: none;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .footer-link {
      color: #b0b0b0;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 0;
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      background: transparent;
      border: none;
    }

    .footer-link ion-icon {
      color: var(--gold-primary);
      font-size: 1.1rem;
      transition: transform 0.4s ease;
    }

    .footer-link:hover {
      color: #ffffff;
      padding-left: 8px;
      background: transparent;
      border: none;
    }

    .footer-link:hover ion-icon {
      transform: translateX(3px);
    }

    .footer-link:after {
      content: '';
      position: absolute;
      bottom: 5px;
      left: 0;
      width: 0;
      height: 1px;
      background-color: var(--gold-primary);
      transition: width 0.4s ease;
    }

    .footer-link:hover:after {
      width: 100%;
    }

    .footer-title {
      color: #fff;
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 25px;
      position: relative;
      padding-bottom: 12px;
      letter-spacing: 0.5px;
    }

    .footer-title:after {
      content: '';
      position: absolute;
      left: 0;
      bottom: 0;
      width: 50px;
      height: 2px;
      background-color: var(--gold-primary);
    }

    /* Modern Footer Styles */
    .modern-footer {
      background-color: #222222;
      color: #fff;
      padding-top: 60px;
    }

    .footer-top {
      padding-bottom: 40px;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
    }

    /* Responsive adjustments */
    @media screen and (max-width: 768px) {
      .footer-grid {
        grid-template-columns: 1fr;
        gap: 40px;
      }
      
      .footer-title:after {
        left: 0;
        transform: none;
      }
    }

    @media screen and (max-width: 480px) {
      .footer-links {
        text-align: left;
      }
      
      .footer-link {
        justify-content: flex-start;
      }
      
      .nav-title::after {
        left: 0;
        transform: none;
      }
    }

    /* Footer Icon Links */
    .footer-icon-link {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(255, 255, 255, 0.07);
      border-radius: 50%;
      padding: 0;
      margin: 0;
      transition: all 0.3s ease;
    }

    .footer-icon-link ion-icon {
      font-size: 1.3rem;
    }

    .footer-icon-link:hover {
      background-color: var(--gold-primary);
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(212, 175, 55, 0.3);
      padding: 0;
    }

    .footer-icon-link:hover ion-icon {
      color: #222222;
      transform: none;
    }

    .footer-icon-link:after {
      display: none;
    }

    .footer-link-list {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 15px;
    }

    @media (max-width: 768px) {
      .footer-link-list {
        justify-content: flex-start;
      }
    }
  </style>

  <!-- Contact Form Submission Script -->
  <script>
    // Contact form submission 
    async function handleContactSubmit(event) {
      event.preventDefault();
      
      // Get form values
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const message = document.getElementById('message').value.trim();
      
      // Validate input
      if (!name || !email || !message) {
        alert('Please fill in all fields');
        return;
      }
      
      // Show loading state
      const submitBtn = event.target.querySelector('.submit-btn');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<ion-icon name="hourglass-outline"></ion-icon> Sending...';
      submitBtn.disabled = true;
      
      try {
        // Send data to server
        const response = await fetch('http://localhost:5000/api/contacts', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ name, email, message })
        });
        
        const data = await response.json();
        
        if (!response.ok) {
          throw new Error(data.error || 'Something went wrong');
        }
        
        // Show success message
        alert('Thank you for your message! We will get back to you soon.');
        
        // Reset form
        event.target.reset();
      } catch (error) {
        console.error('Error submitting contact form:', error);
        alert('There was a problem sending your message. Please try again later.');
      } finally {
        // Restore button state
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    }
  </script>
</body>

</html>